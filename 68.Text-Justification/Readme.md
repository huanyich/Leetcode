First determine the range of each line
be careful of corner case.
